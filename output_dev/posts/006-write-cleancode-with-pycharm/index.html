<!DOCTYPE html>

<html lang="ja">
<head>
<title>Python｜きれいなコードを書くためにPyCharmを設定する｜nnamm.work.work</title>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Pelican" name="generator"/>
<meta content="652239472256159" name="fb:app_id"/>
<meta content="summary_large_image" name="twitter:card"/>
<meta content="@nnammg" name="twitter:site"/>
<meta content="uAnciPeNieWUtkryWWqFeQkRqIkEEzUX7h4A8bSliWY" name="google-site-verification"/>
<meta content="Python｜きれいなコードを書くためにPyCharmを設定する" property="og:title"/>
<meta content="article" property="og:type"/>
<meta content="/posts/006-write-cleancode-with-pycharm/" property="og:url"/>
<meta content="https://nnamm.work/images/posts/006_200518-0.jpg" property="og:image"/>
<meta content="nnamm.work.work" property="og:site_name"/>
<meta content="Black/flake8/isort/mypy/pylintの設定メモ。" property="og:description"/>
<link href="/favicon.ico" rel="shortcut icon"/>
<link href="/apple-touch-icon.png" rel="apple-touch-icon"/>
<link href="/android-chrome-192x192.png" rel="icon" type="image/png"/>
<link href="/theme/css/styles.min.css" rel="stylesheet"/>
<link href="/theme/css/pygments.min.css" rel="stylesheet"/>
</head>
<body>
<header><nav class="flex justify-between items-center inset-x-0 top-0 bg-white border-b border-gray-200">
<a class="inline-flex font-semibold tracking-wider hover:text-pink-400 transition-colors m-4 pl-2 md:pl-4 lg:pl-8" href="/">
    nnamm.work.work
  </a>
<button class="pr-4 py-3 focus:outline-none md:hidden" id="mobileMenuButton" title="Open side menu">
<svg class="w-6 h-6 hidden" fill="none" id="mobileMenuButtonClose" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M6 18L18 6M6 6l12 12" stroke-linejoin="round" stroke-width="2"></path>
</svg>
<svg class="w-6 h-6" fill="none" id="mobileMenuButtonOpen" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M4 6h16M4 12h16M4 18h16" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
</button>
<div class="flex flex-col md:flex-row md:items-center absolute top-0 right-0 z-10 bg-white rounded-bl-md md:bg-opacity-0 transition-all duration-500 transform translate-x-0 -translate-y-full md:translate-y-0 w-1/2 md:w-auto px-3 md:px-0 md:mt-2.5 ld:mt-3 md:mx-1 md:pr-8 lg:pr-12" id="sideMenuHideOnMobile">
<a class="text-sm md:text-xs md:ml-6 lg:ml-10 my-2 py-1 border-b border-transparent hover:border-pink-400 hover:text-pink-400 transition-colors duration-200" href="https://www.behance.net/nnamm" target="_blank">
        Portfolio
          <svg class="inline w-4 h-4 fill-current hover:text-pink-400" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M18 8.101h-4v-.875h4v.875zm.84 6.125c-.77 2.258-5.949 2.966-5.949-1.56 0-4.583 5.508-4.377 6.053-.872.045.295.062.693.055 1.249h-4.41c-.104 1.715 1.76 1.932 2.404 1.184h1.847zm-4.211-2.333h2.624c-.115-1.687-2.36-1.81-2.624 0zm-5.858 4.076h-3.771v-8.73h4.056c3.194.047 3.255 3.176 1.587 4.028 2.019.735 2.086 4.702-1.872 4.702zm-1.896-5.134h1.965c1.464 0 1.696-1.859-.182-1.859h-1.783v1.859zm1.854 1.454h-1.854v1.947h1.824c1.782-.001 1.673-1.947.03-1.947zm3.271-10.289c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12z"></path>
</svg>
</a>
<a class="text-sm md:text-xs md:ml-6 lg:ml-10 my-2 py-1 border-b border-transparent hover:border-pink-400 hover:text-pink-400 transition-colors duration-200" href="https://note.com/tnnamm/m/m2aa9550047ed" target="_blank">
        Stock Photo
          <svg class="inline w-4 h-4 fill-current hover:text-pink-400" viewbox="110 90 230 230" xmlns="http://www.w3.org/2000/svg">
<g fill="none" fill-rule="evenodd" id="normal/logo_symbol" stroke="none" stroke-width="1">
<rect height="400" width="400"></rect>
<path class="fill-current hover:text-pink-400" d="M180.388501,169.6969 L180.388501,155.318324 C180.388501,152.698052 180.524171,151.824229 180.927578,150.479979 C182.005733,146.784785 185.646008,144.030448 189.958629,144.030448 C194.27125,144.030448 197.910324,146.851818 198.988479,150.479979 C199.393087,151.824229 199.528757,152.698052 199.528757,155.318324 L199.528757,177.490682 C199.528757,178.834933 199.528757,180.177986 199.258618,181.388171 C198.517837,184.747003 195.485075,187.771866 192.114939,188.510426 C190.902315,188.778558 189.554021,188.778558 188.205726,188.778558 L165.966674,188.778558 C163.33852,188.778558 162.462069,188.644492 161.113775,188.241097 C157.474701,187.166175 154.644843,183.538015 154.644843,179.238327 C154.644843,174.937443 157.474701,171.309283 161.113775,170.234361 C162.462069,169.830966 163.33852,169.6969 165.966674,169.6969 L180.388501,169.6969 Z M259.642514,270.215259 L140.357486,270.215259 L140.357486,165.464245 C140.357486,164.119995 140.829329,162.97804 141.773015,162.037184 L172.705744,131.196024 C173.64943,130.256366 174.79482,129.785938 176.143114,129.785938 L259.642514,129.785938 L259.642514,270.215259 Z M273.18909,106.134066 C272.582778,106.067033 271.773561,106 270.223563,106 L172.974683,106 C171.897728,106 170.819573,106.067033 170.077591,106.134066 C165.6293,106.537461 161.652852,108.620272 158.485621,111.778004 L122.295384,147.859707 C119.129354,151.018637 117.039078,154.981962 116.63567,159.416912 C116.567235,160.155472 116.5,161.230394 116.5,162.305316 L116.5,280.763379 C116.5,282.308729 116.567235,283.115519 116.63567,283.720012 C117.173547,288.759457 121.756307,293.327276 126.81091,293.864737 C127.418423,293.932967 128.226439,294 129.776437,294 L270.223563,294 C271.773561,294 272.582778,293.932967 273.18909,293.864737 C278.243693,293.327276 282.826453,288.759457 283.365531,283.720012 C283.431565,283.115519 283.5,282.308729 283.5,280.763379 L283.5,119.236621 C283.5,117.691271 283.431565,116.884481 283.365531,116.279988 C282.826453,111.240543 278.243693,106.671527 273.18909,106.134066 Z"></path>
</g>
</svg>
</a>
<a class="text-sm md:text-xs md:ml-6 lg:ml-10 my-2 py-1 border-b border-transparent hover:border-pink-400 hover:text-pink-400 transition-colors duration-200" href="http://localhost:8000/pages/about" target="_self">
        About
      </a>
<a class="text-sm md:text-xs md:ml-6 lg:ml-10 my-2 py-1 border-b border-transparent hover:border-pink-400 hover:text-pink-400 transition-colors duration-200" href="http://localhost:8000/pages/privacy-policy" target="_self">
        Privacy Policy
      </a>
</div>
</nav></header>
<article>
<header class="flex flex-col pt-12 md:pt-20 pb-12">
<h1 class="palt text-2xl md:text-3xl font-semibold w-full md:max-w-3xl md:mx-auto px-4 md:px-10 mb-4">
        Python｜きれいなコードを書くためにPyCharmを設定する</h1>
<div class="flex items-center w-full md:max-w-3xl md:mx-auto px-4 md:px-10 mb-10">
<img alt="Profile image of Takashi Hanamura" class="image-process-crisp w-10 md:w-12 h-10 md:h-12 rounded-full mr-2 md:mr-4" loading="lazy" src="/images/derivatives/crisp/1x/profile_small.jpg" srcset="/images/derivatives/crisp/1x/profile_small.jpg 1x, /images/derivatives/crisp/2x/profile_small.jpg 2x, /images/derivatives/crisp/3x/profile_small.jpg 3x"/>
<div class="text-xs text-gray-400">
<span class="block mb-1">花村貴史 / Takashi Hanamura</span>
<span class="block">
              2020/07/02
              <span>
<svg class="inline-block w-2.5 h-2.5 fill-current text-gray-400" viewbox="100 100 1792 1792" xmlns="http://www.w3.org/2000/svg">
<path d="M1639 1056q0 5-1 7-64 268-268 434.5t-478 166.5q-146 0-282.5-55t-243.5-157l-129 129q-19 19-45 19t-45-19-19-45v-448q0-26 19-45t45-19h448q26 0 45 19t19 45-19 45l-137 137q71 66 161 102t187 36q134 0 250-65t186-179q11-17 53-117 8-23 30-23h192q13 0 22.5 9.5t9.5 22.5zm25-800v448q0 26-19 45t-45 19h-448q-26 0-45-19t-19-45 19-45l138-138q-148-137-349-137-134 0-250 65t-186 179q-11 17-53 117-8 23-30 23h-199q-13 0-22.5-9.5t-9.5-22.5v-7q65-268 270-434.5t480-166.5q146 0 284 55.5t245 156.5l130-129q19-19 45-19t45 19 19 45z"></path>
</svg>
</span>
            2020/05/18
          </span>
</div>
</div>
<img alt="Eye catching image for this article" class="image-process-default w-full max-w-full md:max-w-4xl lg:max-w-5xl md:mx-auto md:rounded" loading="lazy" src="../../images/posts/derivatives/default/1x/006_200518-0.jpg" srcset="../../images/posts/derivatives/default/1x/006_200518-0.jpg 1x, ../../images/posts/derivatives/default/2x/006_200518-0.jpg 2x, ../../images/posts/derivatives/default/3x/006_200518-0.jpg 3x"/>
</header>
<div class="hidden xl:flex xl:justify-center xl:sticky xl:top-4">
<div class="profile-box w-full max-w-screen-xl pointer-events-none">
<div class="flex flex-col items-center mx-auto absolute w-56 mt-12 ml-4 pointer-events-auto">
<img alt="Profile image of Takashi Hanamura" class="image-process-crisp w-32 h-32 rounded-full mb-6" loading="lazy" src="/images/derivatives/crisp/1x/profile_large.jpg" srcset="/images/derivatives/crisp/1x/profile_large.jpg 1x, /images/derivatives/crisp/2x/profile_large.jpg 2x, /images/derivatives/crisp/3x/profile_large.jpg 3x"/>
<p class="text-sm leading-relaxed font-semibold mb-2">花村貴史 / Takashi Hanamura</p>
<p class="text-xs leading-relaxed text-gray-400 mb-4">ソフトウェアエンジニア＆空気感フォトグラファー。Python/Golang/JavaScriptを使ったり、
人や場の「空気感」をそっとすくい撮ることを得意としています。</p>
<hr class="w-full mb-4"/>
<div class="flex">
<a href="https://nnamm.com" target="_blank">
<svg class="aside-external-link mr-4" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M2.597 7.81l4.911 13.454c-3.434-1.668-5.802-.19-5.802-9.264 0-1.493.32-2.91.891-4.19zm16.352 3.67c0-1.272-.457-2.153-.849-2.839-.521-.849-1.011-1.566-1.011-2.415 0-.978.747-1.88 1.862-1.819-1.831-1.677-4.271-2.701-6.951-2.701-3.596 0-6.76 1.845-8.601 4.64.625.02 1.489.032 3.406-.118.555-.034.62.782.066.847 0 0-.558.065-1.178.098l3.749 11.15 2.253-6.756-1.604-4.394c-.555-.033-1.08-.098-1.08-.098-.555-.033-.49-.881.065-.848 2.212.17 3.271.171 5.455 0 .555-.033.621.783.066.848 0 0-.559.065-1.178.098l3.72 11.065 1.027-3.431c.444-1.423.783-2.446.783-3.327zm-6.768 1.42l-3.089 8.975c.922.271 1.898.419 2.908.419 1.199 0 2.349-.207 3.418-.583-.086-.139-3.181-8.657-3.237-8.811zm8.852-5.839c.224 1.651-.099 3.208-.713 4.746l-3.145 9.091c3.061-1.784 5.119-5.1 5.119-8.898 0-1.79-.457-3.473-1.261-4.939zm2.967 4.939c0 6.617-5.384 12-12 12s-12-5.383-12-12 5.383-12 12-12 12 5.383 12 12zm-.55 0c0-6.313-5.137-11.45-11.45-11.45s-11.45 5.137-11.45 11.45 5.137 11.45 11.45 11.45 11.45-5.137 11.45-11.45z"></path>
</svg>
</a>
<a href="https://www.facebook.com/t.hanamura.photography/" target="_blank">
<svg class="aside-external-link mr-4" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm3 8h-1.35c-.538 0-.65.221-.65.778v1.222h2l-.209 2h-1.791v7h-3v-7h-2v-2h2v-2.308c0-1.769.931-2.692 3.029-2.692h1.971v3z"></path>
</svg>
</a>
<a href="https://twitter.com/nnammg" target="_blank">
<svg class="aside-external-link mr-4" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z">
</path>
</svg>
</a>
<a href="https://github.com/nnamm" target="_blank">
<svg class="aside-external-link mr-4" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path>
</svg>
</a>
<a href="https://www.youtube.com/channel/UCvXy78MlFBKnNDMcSrqnOnA" target="_blank">
<svg class="aside-external-link" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"></path>
</svg>
</a>
</div>
</div>
</div>
</div> <div class="entry-content w-full md:max-w-3xl md:mx-auto px-4 md:px-10">
<p>PyCharm できれいなコードを書くために以下のツールを設定しました。</p>
<ul>
<li><a href="https://black.readthedocs.io/en/stable/" target="_blank">Black</a></li>
<li><a href="https://flake8.pycqa.org/en/latest/index.html" target="_blank">flake8</a></li>
<li><a href="https://timothycrosley.github.io/isort/" target="_blank">isort</a></li>
<li><a href="https://github.com/python/mypy" target="_blank">mypy</a></li>
<li><a href="https://www.pylint.org/" target="_blank">Pylint</a></li>
</ul>
<p>PyCharm は標準設定でもコードチェックや整形をやってくれます。それに加え、各種ツールを活用してコーディングルールに沿った開発をしていくことが目的です。</p>
<p><strong>本記事では、PyCharm にファイル監視機能をつけて、保存のたびにチェックする設定方法をまとめます。</strong></p>
<blockquote>
<p><strong>【更新履歴】</strong><br/>
20.6.28｜isort の設定を変更。multi_line_output に関する設定を削除。import を 1 行表示とするために force_single_line=true を追加。<br/>
20.5.27｜isort を追加。flake8 の設定を変更（ 1 行の文字数を 120 → 88 ）。<br/>
20.5.21｜flake8 などの設定を見直し<br/>
20.5.18｜公開</p>
</blockquote>
<h2 id="file-watchers">File Watchers プラグイン（ファイル監視機能）</h2>
<p>まずはファイルを監視してくれるプラグインを導入します。</p>
<p>Preferences → Plugins → <code>file watchers</code>と検索して Go!!</p>
<p><img alt="" class="image-process-crisp" loading="lazy" src="../../images/posts/derivatives/crisp/1x/006_200518-1.jpg" srcset="../../images/posts/derivatives/crisp/1x/006_200518-1.jpg 1x, ../../images/posts/derivatives/crisp/2x/006_200518-1.jpg 2x, ../../images/posts/derivatives/crisp/3x/006_200518-1.jpg 3x"/></p>
<p>インストールすると、Preferences → Tools に<code>File Watchers</code>の項目が追加されます。ここに各種ツールの設定を書きます。</p>
<p><img alt="" class="image-process-crisp" loading="lazy" src="../../images/posts/derivatives/crisp/1x/006_200518-2.jpg" srcset="../../images/posts/derivatives/crisp/1x/006_200518-2.jpg 1x, ../../images/posts/derivatives/crisp/2x/006_200518-2.jpg 2x, ../../images/posts/derivatives/crisp/3x/006_200518-2.jpg 3x"/></p>
<h2 id="black">Black （コードフォーマッター）</h2>
<p><a href="https://black.readthedocs.io/en/stable/" target="_blank">Black</a>は Python3.6 以上で使える超強力なコードフォーマッターです。PEP8 に準拠しているのはもちろん、「より制限のきつい PEP8」と言われている存在。ユーザーからはほとんど設定変更ができないガッチガチ仕様。</p>
<p>▶︎ <a href="https://black.readthedocs.io/en/stable/" target="_blank">The uncompromising code formatter</a></p>
<blockquote>
<p>記事投稿時点ではベータ版なので、今後仕様変更される可能性はあります。</p>
</blockquote>
<h3 id="_1">■ 設定</h3>
<p>Black の設定は<code>pyproject.toml</code>を使用します。プロジェクト直下に生成し、1 行の文字数を 88 （ Black デフォルト）にしました。</p>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="nx">tool</span><span class="p">.</span><span class="nx">black</span><span class="p">]</span>
<span class="nx">line</span><span class="o">-</span><span class="nx">length</span> <span class="o">=</span> <span class="mf">88</span>
</code></pre></div>
<p>PyCharm の File Watchers は以下のようにします。</p>
<p><img alt="" class="image-process-crisp" loading="lazy" src="../../images/posts/derivatives/crisp/1x/006_200518-3.jpg" srcset="../../images/posts/derivatives/crisp/1x/006_200518-3.jpg 1x, ../../images/posts/derivatives/crisp/2x/006_200518-3.jpg 2x, ../../images/posts/derivatives/crisp/3x/006_200518-3.jpg 3x"/></p>
<table>
<thead>
<tr>
<th>項目</th>
<th>設定値</th>
</tr>
</thead>
<tbody>
<tr>
<td>Name</td>
<td>Black （任意名）</td>
</tr>
<tr>
<td>File type</td>
<td>Python</td>
</tr>
<tr>
<td>Scope</td>
<td>Current Fles or Project Files など</td>
</tr>
<tr>
<td>Program</td>
<td>$PyInterpreterDirectory$/black</td>
</tr>
<tr>
<td>Arguments</td>
<td>$FilePath$</td>
</tr>
<tr>
<td>Output paths to refresh</td>
<td>$FilePath$</td>
</tr>
<tr>
<td>Working directory</td>
<td>$ProjectFileDir$</td>
</tr>
<tr>
<td>Auto-save edited files to trigger the watcher</td>
<td>off</td>
</tr>
<tr>
<td>Trigger the watcher on external changes</td>
<td>off</td>
</tr>
</tbody>
</table>
<p><code>black --help</code>やリファレンスを見ながら設定しました。</p>
<p>「Tool to Run on Changes」は、CUI でコマンド入力する状態を GUI から設定できるってイメージ。Black は標準で<code>pyproject.toml</code>を読み込むので、引数は Python のファイルパスだけです。</p>
<h3 id="xxxxxxxxxx">■$xxxxxxxxxx$について</h3>
<p>プロジェクトディレクトリなどを表すショートカットです。「Tool to Run on Changes」の各欄の「+」をクリックすると選択できます。</p>
<h2 id="flake8">flake8 （静的文法チェックツール）</h2>
<p><a href="https://flake8.pycqa.org/en/latest/index.html" target="_blank">flake8</a>は静的な文法チェックツール。以下をラッパーしており、使っていない変数のチェックなど、「これおかしいよー」という箇所を検出してくれます。</p>
<ul>
<li>PyFlakes</li>
<li>pycodestyle</li>
<li>Ned Batchelder’s McCabe script</li>
</ul>
<h3 id="_2">■ 設定</h3>
<p>設定ファイルは一元管理したいので<code>pyproject.toml</code>に書きます。1 行の文字数を Black に合わせたり、循環的複雑度を設定しました。</p>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="nx">flake8</span><span class="p">]</span>
<span class="nx">max</span><span class="o">-</span><span class="nx">line</span><span class="o">-</span><span class="nx">length</span> <span class="o">=</span> <span class="mf">88</span>
<span class="nx">max</span><span class="o">-</span><span class="nx">complexity</span> <span class="o">=</span> <span class="mf">20</span>
</code></pre></div>
<p><img alt="" class="image-process-crisp" loading="lazy" src="../../images/posts/derivatives/crisp/1x/006_200518-4.jpg" srcset="../../images/posts/derivatives/crisp/1x/006_200518-4.jpg 1x, ../../images/posts/derivatives/crisp/2x/006_200518-4.jpg 2x, ../../images/posts/derivatives/crisp/3x/006_200518-4.jpg 3x"/></p>
<table>
<thead>
<tr>
<th>項目</th>
<th>設定値</th>
</tr>
</thead>
<tbody>
<tr>
<td>Name</td>
<td>flake8 （任意名）</td>
</tr>
<tr>
<td>File type</td>
<td>Python</td>
</tr>
<tr>
<td>Scope</td>
<td>Current Fles or Project Files など</td>
</tr>
<tr>
<td>Program</td>
<td>$PyInterpreterDirectory$/flake8</td>
</tr>
<tr>
<td>Arguments</td>
<td>--statistics --config $ContentRoot$/pyproject.toml --ignore E203,W503,W504 $FilePath$</td>
</tr>
<tr>
<td>Output paths to refresh</td>
<td>$FilePath$</td>
</tr>
<tr>
<td>Working directory</td>
<td>$ProjectFileDir$</td>
</tr>
<tr>
<td>Auto-save edited files to trigger the watcher</td>
<td>off</td>
</tr>
<tr>
<td>Trigger the watcher on external changes</td>
<td>off</td>
</tr>
</tbody>
</table>
<p><code>flake8 --help</code>やリファレンスを見ながら設定しました。</p>
<h3 id="ignore">■ignore の指定について</h3>
<p>flake8 で特定の警告やエラーを無効にしたい場合は、toml ファイルにこう書きます。</p>
<blockquote>
<p>ignore = 'E203', 'W503', 'W504'<br/>（ Black との衝突を防ぐコード）</p>
</blockquote>
<p>しかし、なぜか PyCharm ではエラーとなります。toml にエラーがあると他のチェッカーが誤動作しますので、回避策として File Watchers で「--ignore」指定することにしました。（テープルの設定値参照）</p>
<h2 id="isort">isort （コードフォーマッター）</h2>
<p><a href="https://timothycrosley.github.io/isort/" target="_blank">isort</a>は import/from 部分を PEP8 に準じてソートしてくれるフォーマッターです。Black はそこまで整形してくれないんですよね。</p>
<h3 id="_3">■ 設定</h3>
<p>こちらも<code>pyproject.toml</code>に書きます。Black との衝突を防ぐために文字数を合わせます。<code>multi_line_output</code>には複数行になる場合のソート方法を指定します。</p>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="nx">tool</span><span class="p">.</span><span class="nx">isort</span><span class="p">]</span>
<span class="nx">line_length</span> <span class="o">=</span> <span class="mf">88</span>
<span class="nx">force_single_line</span> <span class="o">=</span> <span class="kc">true</span>

<span class="err">（</span><span class="mf">20.6.28</span> <span class="nx">以下削除</span><span class="err">）</span>
<span class="err">#</span><span class="nx">include_trailing_comma</span> <span class="o">=</span> <span class="kc">true</span>
<span class="err">#</span><span class="nx">multi_line_output</span> <span class="o">=</span> <span class="mf">3</span>
</code></pre></div>
<p><img alt="" class="image-process-crisp" loading="lazy" src="../../images/posts/derivatives/crisp/1x/006_200518-8.jpg" srcset="../../images/posts/derivatives/crisp/1x/006_200518-8.jpg 1x, ../../images/posts/derivatives/crisp/2x/006_200518-8.jpg 2x, ../../images/posts/derivatives/crisp/3x/006_200518-8.jpg 3x"/></p>
<table>
<thead>
<tr>
<th>項目</th>
<th>設定値</th>
</tr>
</thead>
<tbody>
<tr>
<td>Name</td>
<td>isort （任意名）</td>
</tr>
<tr>
<td>File type</td>
<td>Python</td>
</tr>
<tr>
<td>Scope</td>
<td>Current Fles or Project Files など</td>
</tr>
<tr>
<td>Program</td>
<td>$PyInterpreterDirectory$/isort</td>
</tr>
<tr>
<td>Arguments</td>
<td>$FilePath$</td>
</tr>
<tr>
<td>Output paths to refresh</td>
<td>$FilePath$</td>
</tr>
<tr>
<td>Working directory</td>
<td>$ProjectFileDir$</td>
</tr>
<tr>
<td>Auto-save edited files to trigger the watcher</td>
<td>off</td>
</tr>
<tr>
<td>Trigger the watcher on external changes</td>
<td>off</td>
</tr>
</tbody>
</table>
<p><code>isort --help</code>でいろいろ確認できます。</p>
<h3 id="_4">■ 導入時の注意点</h3>
<p>isort を普通にインストールすると<code>~/.isort.cfg</code>を参照します。<code>pyproject.toml</code>で一元管理するためには<code>pip install 'isort[pyproject]'</code>とするか、PyCharm からなら<code>Options</code>に<code>pyporject</code>を指定すれば OK です。</p>
<p><img alt="" class="image-process-crisp" loading="lazy" src="../../images/posts/derivatives/crisp/1x/006_200518-9.jpg" srcset="../../images/posts/derivatives/crisp/1x/006_200518-9.jpg 1x, ../../images/posts/derivatives/crisp/2x/006_200518-9.jpg 2x, ../../images/posts/derivatives/crisp/3x/006_200518-9.jpg 3x"/></p>
<h2 id="mypy">mypy （静的型ヒントチェッカー）</h2>
<p><a href="https://github.com/python/mypy" target="_blank">mypy</a>は静的な型ヒントチェッカーです。flake8 と同じようなもので「適切に型ヒントかけているかな？」という観点でみてくれます。</p>
<h3 id="_5">■ 設定</h3>
<p>こちらも<code>pyproject.toml</code>に書いちゃいます。</p>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="nx">mypy</span><span class="p">]</span>
<span class="nx">ignore_missing_imports</span> <span class="o">=</span> <span class="mf">1</span>
</code></pre></div>
<p><img alt="" class="image-process-crisp" loading="lazy" src="../../images/posts/derivatives/crisp/1x/006_200518-5.jpg" srcset="../../images/posts/derivatives/crisp/1x/006_200518-5.jpg 1x, ../../images/posts/derivatives/crisp/2x/006_200518-5.jpg 2x, ../../images/posts/derivatives/crisp/3x/006_200518-5.jpg 3x"/></p>
<table>
<thead>
<tr>
<th>項目</th>
<th>設定値</th>
</tr>
</thead>
<tbody>
<tr>
<td>Name</td>
<td>mypy （任意名）</td>
</tr>
<tr>
<td>File type</td>
<td>Python</td>
</tr>
<tr>
<td>Scope</td>
<td>Current Fles or Project Files など</td>
</tr>
<tr>
<td>Program</td>
<td>$PyInterpreterDirectory$/mypy</td>
</tr>
<tr>
<td>Arguments</td>
<td>--config-file $ContentRoot$/pyproject.toml $FilePath$</td>
</tr>
<tr>
<td>Output paths to refresh</td>
<td>$FilePath$</td>
</tr>
<tr>
<td>Working directory</td>
<td>$ProjectFileDir$</td>
</tr>
<tr>
<td>Auto-save edited files to trigger the watcher</td>
<td>off</td>
</tr>
<tr>
<td>Trigger the watcher on external changes</td>
<td>off</td>
</tr>
</tbody>
</table>
<p><code>mypy --help</code>でいろいろ確認できます。</p>
<h2 id="pylint">Pylint （静的文法チェックツール）</h2>
<p><a href="https://www.pylint.org/" target="_blank">Pylint</a>は静的な文法チェックツールです。flake8 と重複する部分もあるでしょうけど、両方採用して厳しめにチェックしてもいいだろうと。たとえば、flake8 と Pylint で引っ掛かったら、絶対に直すべきポイントだと思います。</p>
<h3 id="_6">■ 設定</h3>
<p>Pylint も<code>pyproject.toml</code>に設定できますが、<code>.pylintrc</code>に書くことにしました。<code>pylint --generate-rcfile</code>するとたくさんの標準設定があり、それらを有効にしておいた方が良いと考えたためです。</p>
<p>ただ、このままだと多くの変数にたいして「大文字にせぃ」とのたまってきます。変数は小文字が普通だと思うのですが（ですよね？）</p>
<p>というわけで、「名前について文句ゆーな」という設定や Black との衝突を防ぐための＋ α を<code>.pylintrc</code>に書き込みます。</p>
<div class="highlight"><pre><span></span><code><span class="c1">// 設定ファイル生成</span>
<span class="nx">$</span> <span class="nx">pylint</span> <span class="o">--</span><span class="nx">generate</span><span class="o">-</span><span class="nx">rcfile</span> <span class="o">&gt;</span> <span class="p">.</span><span class="nx">pylintrc</span>

<span class="nx">$</span> <span class="nx">vim</span> <span class="p">.</span><span class="nx">pylintrc</span>

<span class="c1">// [MESSAGES CONTROL]セクションの”disable=”に以下を追記</span>
<span class="o">+</span> <span class="nx">invalid</span><span class="o">-</span><span class="nx">name</span>
<span class="o">+</span> <span class="nx">bad</span><span class="o">-</span><span class="nx">continuation</span>

<span class="c1">// [FORMAT]セクションで1行当たりの文字数を他と揃える</span>
<span class="o">-</span> <span class="nx">max</span><span class="o">-</span><span class="nx">line</span><span class="o">-</span><span class="nx">length</span><span class="o">=</span><span class="mf">100</span>
<span class="o">+</span> <span class="nx">max</span><span class="o">-</span><span class="nx">line</span><span class="o">-</span><span class="nx">length</span><span class="o">=</span><span class="mf">88</span> 

<span class="c1">// [DESIGN]セクションで最低バブリックメソッド数を変更（必要に応じて）</span>
<span class="o">-</span> <span class="nx">min</span><span class="o">-</span><span class="nx">public</span><span class="o">-</span><span class="nx">methods</span><span class="o">=</span><span class="mf">2</span>
<span class="o">+</span> <span class="nx">min</span><span class="o">-</span><span class="nx">public</span><span class="o">-</span><span class="nx">methods</span><span class="o">=</span><span class="mf">0</span> <span class="nx">or</span> <span class="mf">1</span>
</code></pre></div>
<p><img alt="" class="image-process-crisp" loading="lazy" src="../../images/posts/derivatives/crisp/1x/006_200518-6.jpg" srcset="../../images/posts/derivatives/crisp/1x/006_200518-6.jpg 1x, ../../images/posts/derivatives/crisp/2x/006_200518-6.jpg 2x, ../../images/posts/derivatives/crisp/3x/006_200518-6.jpg 3x"/></p>
<table>
<thead>
<tr>
<th>項目</th>
<th>設定値</th>
</tr>
</thead>
<tbody>
<tr>
<td>Name</td>
<td>pylint （任意名）</td>
</tr>
<tr>
<td>File type</td>
<td>Python</td>
</tr>
<tr>
<td>Scope</td>
<td>Current Fles or Project Files など</td>
</tr>
<tr>
<td>Program</td>
<td>$PyInterpreterDirectory$/pylint</td>
</tr>
<tr>
<td>Arguments</td>
<td>--rcfile $ContentRoot$/.pylintrc $FilePath$</td>
</tr>
<tr>
<td>Output paths to refresh</td>
<td>$FilePath$</td>
</tr>
<tr>
<td>Working directory</td>
<td>$ProjectFileDir$</td>
</tr>
<tr>
<td>Auto-save edited files to trigger the watcher</td>
<td>off</td>
</tr>
<tr>
<td>Trigger the watcher on external changes</td>
<td>off</td>
</tr>
</tbody>
</table>
<h3 id="pylint_1">■Pylint は基本的に無効</h3>
<p>僕の環境では Pylint 処理にほんちょっと時間がかかります。保存のたびに「このちょっと」が気になるので、Pylint の自動処理を無効としておき、折を見て有効にしています。</p>
<p>有効・無効は File Watchers 設定画面のチェックボックス ON/OFF でできます。</p>
<blockquote>
<p>しばらく使ってみたところ、ちょっとした時間はとくに気にならないため常に有効としました。（ 2020.5.21 ）</p>
</blockquote>
<h2 id="_7">設定ファイルはエクスポートしておくと楽</h2>
<p>これまで設定したものを他のプロジェクトに流用できるよう、設定ファイルのインポート／エクスポート機能があります。</p>
<p>File Watchers 設定画面の下部にある矢印アイコンがそれ。右上矢印がエクスポート、左下矢印がインポート。</p>
<p><img alt="" class="image-process-crisp" loading="lazy" src="../../images/posts/derivatives/crisp/1x/006_200518-7.jpg" srcset="../../images/posts/derivatives/crisp/1x/006_200518-7.jpg 1x, ../../images/posts/derivatives/crisp/2x/006_200518-7.jpg 2x, ../../images/posts/derivatives/crisp/3x/006_200518-7.jpg 3x"/></p>
<p><code>pyproject.toml</code>や<code>.pylintrc</code>も一緒に保存しておくと非常に楽ですよ。</p>
<h2 id="_8">おわりに</h2>
<p>Python の良い点に「コードの読みやすさ」があります。でも、PEP8 などのルールを無視して書いていたらその良さは活かせません。だから、この手のことは IT の力に任せちゃいましょう。</p>
<p>今回は PyCharm で設定しましたけど、Visual Studio Code でも同様の設定はできるので、自分の好きなエディタで開発を楽しんでいけばいいと思います。</p>
<h2 id="_9">参考にさせていただいた記事</h2>
<ul>
<li><a href="https://logmi.jp/tech/articles/322611" target="_blank">Python 開発を円滑に進めるためのツール設定 Part.1 - ログミー Tech</a></li>
</ul>
<p>ことの発端となった記事です。実務はこうなのか〜と知って「じゃあ、僕もやってみよう」となったのでした。</p>
<p>そのほかの参考記事はこちら。</p>
<ul>
<li><a href="https://qiita.com/navitime_tech/items/0a431a2d74c156d0bda2" target="_blank">black と pylint を使った快適な Python 開発 - Qiita</a></li>
<li><a href="https://blog.hirokiky.org/entry/2019/06/03/202745" target="_blank">もう Python の細かい書き方で議論しない。black で自動フォーマットしよう - Make 組ブログ</a></li>
</ul>
</div>
<div class="w-full md:max-w-3xl md:mx-auto mt-12 mb-20 px-4 md:px-10">
<div>
<svg class="inline-block w-4 h-4 fill-current text-gray-700 py-0.5" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M11 5c-1.629 0-2.305-1.058-4-3h-7v20h24v-17h-13z"></path>
</svg>
<a class="metadata-category-link inline-block mr-2" href="/category/python.html">
    Python
  </a>
<div class="inline md:hidden"><br/></div>
<svg class="inline-block w-4 h-4 fill-current text-gray-700 py-0.5" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M10.605 0h-10.605v10.609l13.391 13.391 10.609-10.604-13.395-13.396zm-4.191 6.414c-.781.781-2.046.781-2.829.001-.781-.783-.781-2.048 0-2.829.782-.782 2.048-.781 2.829-.001.782.782.781 2.047 0 2.829z"></path>
</svg>
<a class="metadata-tags-link inline-block" href="/tag/pycharm.html">
      PyCharm
    </a>
<a class="metadata-tags-link inline-block" href="/tag/python.html">
      Python
    </a>
</div> </div>
</article>
<footer><div class="flex flex-col justify-center items-center bg-white border-t border-gray-200 mt-8 pt-12 pb-8">
<div class="flex flex-row justify-evenly w-7/12 md:w-4/12 mb-8">
<a href="https://nnamm.com" target="_blank">
<svg class="footer-external-link" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M2.597 7.81l4.911 13.454c-3.434-1.668-5.802-.19-5.802-9.264 0-1.493.32-2.91.891-4.19zm16.352 3.67c0-1.272-.457-2.153-.849-2.839-.521-.849-1.011-1.566-1.011-2.415 0-.978.747-1.88 1.862-1.819-1.831-1.677-4.271-2.701-6.951-2.701-3.596 0-6.76 1.845-8.601 4.64.625.02 1.489.032 3.406-.118.555-.034.62.782.066.847 0 0-.558.065-1.178.098l3.749 11.15 2.253-6.756-1.604-4.394c-.555-.033-1.08-.098-1.08-.098-.555-.033-.49-.881.065-.848 2.212.17 3.271.171 5.455 0 .555-.033.621.783.066.848 0 0-.559.065-1.178.098l3.72 11.065 1.027-3.431c.444-1.423.783-2.446.783-3.327zm-6.768 1.42l-3.089 8.975c.922.271 1.898.419 2.908.419 1.199 0 2.349-.207 3.418-.583-.086-.139-3.181-8.657-3.237-8.811zm8.852-5.839c.224 1.651-.099 3.208-.713 4.746l-3.145 9.091c3.061-1.784 5.119-5.1 5.119-8.898 0-1.79-.457-3.473-1.261-4.939zm2.967 4.939c0 6.617-5.384 12-12 12s-12-5.383-12-12 5.383-12 12-12 12 5.383 12 12zm-.55 0c0-6.313-5.137-11.45-11.45-11.45s-11.45 5.137-11.45 11.45 5.137 11.45 11.45 11.45 11.45-5.137 11.45-11.45z"></path>
</svg>
</a>
<a href="https://www.facebook.com/t.hanamura.photography/" target="_blank">
<svg class="footer-external-link" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm3 8h-1.35c-.538 0-.65.221-.65.778v1.222h2l-.209 2h-1.791v7h-3v-7h-2v-2h2v-2.308c0-1.769.931-2.692 3.029-2.692h1.971v3z"></path>
</svg>
</a>
<a href="https://twitter.com/nnammg" target="_blank">
<svg class="footer-external-link" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z">
</path>
</svg>
</a>
<a href="https://github.com/nnamm" target="_blank">
<svg class="footer-external-link" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path>
</svg>
</a>
<a href="https://www.youtube.com/channel/UCvXy78MlFBKnNDMcSrqnOnA" target="_blank">
<svg class="footer-external-link" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"></path>
</svg>
</a>
</div>
<div class="flex flex-col text-center">
<address class="text-xs not-italic mb-2">
      Powered by <a class="underline" href="https://getpelican.com/" target="_blank">Pelican</a>,
      which takes great advantage of <a class="underline" href="https://www.python.org/" target="_blank">Python</a>.
    </address>
<small><a class="hover:text-pink-400 transition-colors" href="/">nnamm.work</a> ©2020</small>
</div>
</div></footer>
<script>
  let mobileMenuButton = document.getElementById('mobileMenuButton')
  mobileMenuButton.onclick = function () {
    document.getElementById('sideMenuHideOnMobile').classList.toggle('-translate-y-full')
    document.getElementById('sideMenuHideOnMobile').classList.toggle('mt-12')
    document.getElementById('sideMenuHideOnMobile').classList.toggle('shadow')
    document.getElementById('mobileMenuButtonClose').classList.toggle('hidden')
    document.getElementById('mobileMenuButtonOpen').classList.toggle('hidden')
  }
  // Hide element when click outside nav
  let theElementContainer = document.getElementsByTagName('nav')[0]
  document.addEventListener('click', function (event) {
    if (!theElementContainer.contains(event.target)) {
      document.getElementById('sideMenuHideOnMobile').classList.add('-translate-y-full')
      document.getElementById('sideMenuHideOnMobile').classList.remove('mt-12')
      document.getElementById('sideMenuHideOnMobile').classList.remove('shadow')
      document.getElementById('mobileMenuButtonOpen').classList.remove('hidden')
      document.getElementById('mobileMenuButtonClose').classList.add('hidden')
    }
  })
</script>
<script>
  window.addEventListener('load', () => {
    viewSlide('.slideshow img')
  })

  function viewSlide(className, slideNo = -1) {
    let imgArray = document.querySelectorAll(className)
    if (imgArray.length) {
      if (slideNo >= 0) {
        imgArray[slideNo].style.opacity = '0'
      }
      slideNo++
      if (slideNo >= imgArray.length) {
        slideNo = 0
      }
      imgArray[slideNo].style.opacity = '1'
      let msec = 5000
      setTimeout(() => {
        viewSlide(className, slideNo)
      }, msec)
    }
  }
</script>
<script>
  let scrollAnimationElm = document.querySelectorAll('.profile-box')
  let scrollAnimationFunc = () => {
    for (let i = 0; i < scrollAnimationElm.length; i++) {
      let triggerMargin = 600
      if (window.innerHeight > scrollAnimationElm[i].getBoundingClientRect().top + triggerMargin) {
        scrollAnimationElm[i].classList.add('show')
      }
    }
  }
  window.addEventListener('load', scrollAnimationFunc)
  window.addEventListener('scroll', scrollAnimationFunc)
</script>
</body>
</html>