<!DOCTYPE html>

<html lang="ja">
<head>
<title>Gridsome｜v-ifを使いテンプレート内でデザインを分ける｜nnamm.work</title>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Pelican" name="generator"/>
<meta content="652239472256159" name="fb:app_id"/>
<meta content="summary_large_image" name="twitter:card"/>
<meta content="@nnammg" name="twitter:site"/>
<meta content="uAnciPeNieWUtkryWWqFeQkRqIkEEzUX7h4A8bSliWY" name="google-site-verification"/>
<meta content="Gridsome｜v-ifを使いテンプレート内でデザインを分ける" property="og:title"/>
<meta content="article" property="og:type"/>
<meta content="/posts/005-separate-the-designs/" property="og:url"/>
<meta content="https://nnamm.work/images/posts/005_200504-0.jpg" property="og:image"/>
<meta content="nnamm.work" property="og:site_name"/>
<meta content="multi templatesでは想定する動作にならないため、条件付きレンダリングでデザインを分けました。" property="og:description"/>
<link href="/favicon.ico" rel="shortcut icon"/>
<link href="/apple-touch-icon.png" rel="apple-touch-icon"/>
<link href="/android-chrome-192x192.png" rel="icon" type="image/png"/>
<link href="/theme/css/styles.min.css" rel="stylesheet"/>
<link href="/theme/css/pygments.min.css" rel="stylesheet"/>
</head>
<body>
<header><nav class="flex justify-between items-center inset-x-0 top-0 bg-white border-b border-gray-200">
<a class="inline-flex text-lg font-semibold tracking-wider hover:text-pink-400 transition-colors m-4 pl-2 md:pl-4 lg:pl-8" href="/">
    nnamm.work
  </a>
<button class="pr-4 py-3 focus:outline-none md:hidden" id="mobileMenuButton" title="Open side menu">
<svg class="w-6 h-6 hidden" fill="none" id="mobileMenuButtonClose" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M6 18L18 6M6 6l12 12" stroke-linejoin="round" stroke-width="2"></path>
</svg>
<svg class="w-6 h-6" fill="none" id="mobileMenuButtonOpen" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M4 6h16M4 12h16M4 18h16" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
</button>
<div class="flex flex-col md:flex-row md:items-center absolute top-0 right-0 z-10 bg-white rounded-bl-md md:bg-opacity-0 transition-all duration-500 transform translate-x-0 -translate-y-full md:translate-y-0 w-1/2 md:w-auto px-3 md:px-0 md:mt-2.5 ld:mt-3 md:mx-1 md:pr-8 lg:pr-12" id="sideMenuHideOnMobile">
<a class="text-sm md:ml-6 lg:ml-10 my-2 py-1 border-b border-transparent hover:border-pink-400 hover:text-pink-400 transition-colors duration-200" href="https://thanamura.tumblr.com" target="_blank">
        Portfolio -private-
      </a>
<a class="text-sm md:ml-6 lg:ml-10 my-2 py-1 border-b border-transparent hover:border-pink-400 hover:text-pink-400 transition-colors duration-200" href="https://thanamura-portrait.tumblr.com" target="_blank">
        Portfolio -works-
      </a>
<a class="text-sm md:ml-6 lg:ml-10 my-2 py-1 border-b border-transparent hover:border-pink-400 hover:text-pink-400 transition-colors duration-200" href="https://note.com/tnnamm/m/m2aa9550047ed" target="_blank">
        Stock Photo
      </a>
<a class="text-sm md:ml-6 lg:ml-10 my-2 py-1 border-b border-transparent hover:border-pink-400 hover:text-pink-400 transition-colors duration-200" href="http://localhost:8000/pages/about" target="_self">
        About
      </a>
<a class="text-sm md:ml-6 lg:ml-10 my-2 py-1 border-b border-transparent hover:border-pink-400 hover:text-pink-400 transition-colors duration-200" href="http://localhost:8000/pages/privacy-policy" target="_self">
        Privacy Policy
      </a>
</div>
</nav></header>
<article>
<header class="flex flex-col pt-12 md:pt-20 pb-12">
<h1 class="palt text-2xl md:text-3xl font-semibold w-full md:max-w-3xl md:mx-auto px-4 md:px-10 mb-4">
        Gridsome｜v-ifを使いテンプレート内でデザインを分ける</h1>
<div class="flex items-center w-full md:max-w-3xl md:mx-auto px-4 md:px-10 mb-10">
<img alt="Profile image of Takashi Hanamura" class="image-process-crisp w-10 md:w-12 h-10 md:h-12 rounded-full mr-2 md:mr-4" loading="lazy" src="/images/derivatives/crisp/1x/profile_small.jpg" srcset="/images/derivatives/crisp/1x/profile_small.jpg 1x, /images/derivatives/crisp/2x/profile_small.jpg 2x, /images/derivatives/crisp/3x/profile_small.jpg 3x"/>
<div class="text-xs text-gray-500">
<span class="block mb-1">花村貴史 / Takashi Hanamura</span>
<span class="block">
            2020/05/04
          </span>
</div>
</div>
<img alt="Eye catching image for this article" class="image-process-default w-full max-w-full md:max-w-4xl lg:max-w-5xl md:mx-auto md:rounded" loading="lazy" src="../../images/posts/derivatives/default/1x/005_200504-0.jpg" srcset="../../images/posts/derivatives/default/1x/005_200504-0.jpg 1x, ../../images/posts/derivatives/default/2x/005_200504-0.jpg 2x, ../../images/posts/derivatives/default/3x/005_200504-0.jpg 3x"/>
</header>
<div class="hidden xl:flex xl:justify-center xl:sticky xl:top-4">
<div class="profile-box w-full max-w-screen-xl pointer-events-none">
<div class="flex flex-col items-center mx-auto absolute w-56 mt-12 ml-3 pointer-events-auto">
<img alt="Profile image of Takashi Hanamura" class="image-process-crisp w-32 h-32 rounded-full mb-6" loading="lazy" src="/images/derivatives/crisp/1x/profile_large_old.jpg" srcset="/images/derivatives/crisp/1x/profile_large_old.jpg 1x, /images/derivatives/crisp/2x/profile_large_old.jpg 2x, /images/derivatives/crisp/3x/profile_large_old.jpg 3x"/>
<p class="text-sm leading-relaxed font-semibold mb-2">花村貴史 / Takashi Hanamura</p>
<p class="text-xs leading-relaxed text-gray-500 mb-4">ソフトウェアエンジニア＆空気感フォトグラファー。オシゴトは SAP ですが、プライベートでは Python/Golang/TS/JS 周辺を嗜みつつ、人や場の「空気感」をそっとすくい撮ることを得意としています。</p>
<hr class="w-full mb-4"/>
<div class="flex">
<a href="https://nnamm.com" target="_blank">
<svg class="aside-external-link mr-4" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M2.597 7.81l4.911 13.454c-3.434-1.668-5.802-.19-5.802-9.264 0-1.493.32-2.91.891-4.19zm16.352 3.67c0-1.272-.457-2.153-.849-2.839-.521-.849-1.011-1.566-1.011-2.415 0-.978.747-1.88 1.862-1.819-1.831-1.677-4.271-2.701-6.951-2.701-3.596 0-6.76 1.845-8.601 4.64.625.02 1.489.032 3.406-.118.555-.034.62.782.066.847 0 0-.558.065-1.178.098l3.749 11.15 2.253-6.756-1.604-4.394c-.555-.033-1.08-.098-1.08-.098-.555-.033-.49-.881.065-.848 2.212.17 3.271.171 5.455 0 .555-.033.621.783.066.848 0 0-.559.065-1.178.098l3.72 11.065 1.027-3.431c.444-1.423.783-2.446.783-3.327zm-6.768 1.42l-3.089 8.975c.922.271 1.898.419 2.908.419 1.199 0 2.349-.207 3.418-.583-.086-.139-3.181-8.657-3.237-8.811zm8.852-5.839c.224 1.651-.099 3.208-.713 4.746l-3.145 9.091c3.061-1.784 5.119-5.1 5.119-8.898 0-1.79-.457-3.473-1.261-4.939zm2.967 4.939c0 6.617-5.384 12-12 12s-12-5.383-12-12 5.383-12 12-12 12 5.383 12 12zm-.55 0c0-6.313-5.137-11.45-11.45-11.45s-11.45 5.137-11.45 11.45 5.137 11.45 11.45 11.45 11.45-5.137 11.45-11.45z"></path>
</svg>
</a>
<a href="https://www.facebook.com/t.hanamura.photography/" target="_blank">
<svg class="aside-external-link mr-4" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm3 8h-1.35c-.538 0-.65.221-.65.778v1.222h2l-.209 2h-1.791v7h-3v-7h-2v-2h2v-2.308c0-1.769.931-2.692 3.029-2.692h1.971v3z"></path>
</svg>
</a>
<a href="https://twitter.com/nnammg" target="_blank">
<svg class="aside-external-link mr-4" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z">
</path>
</svg>
</a>
<a href="https://github.com/nnamm" target="_blank">
<svg class="aside-external-link mr-4" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path>
</svg>
</a>
<a href="https://www.youtube.com/channel/UCvXy78MlFBKnNDMcSrqnOnA" target="_blank">
<svg class="aside-external-link" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"></path>
</svg>
</a>
</div>
</div>
</div>
</div> <div class="entry-content w-full md:max-w-3xl md:mx-auto px-4 md:px-10">
<p>Gridsome には「multiple templates for a collection」という仕組みがあって、1 つのコレクションを複数のテンプレートに対応させることができます。</p>
<p>参考：<a href="https://gridsome.org/docs/templates/" target="_blank">Templates - Gridsome</a></p>
<p>基本的にコレクション（ md ファイル等）とテンプレート（ vue ファイル）は 1 対 1 の関係ですが、任意のページだけ専用のテンプレートを適用できるもの、と僕は理解してます。</p>
<p>しかし、Build すると同じ記事データが複数生成されてしまい、記事の重複が起こりました。</p>
<p>dist をそのままサーバーにアップロードしたら SEO 的にどうなの？と考えた末、ひとまず、テンプレート内で「v-if / v-if-else / v-else」を使って乗り切ることにしました。</p>
<p><img alt="" class="image-process-crisp" loading="lazy" src="../../images/posts/derivatives/crisp/1x/005_200504-1.jpg" srcset="../../images/posts/derivatives/crisp/1x/005_200504-1.jpg 1x, ../../images/posts/derivatives/crisp/2x/005_200504-1.jpg 2x, ../../images/posts/derivatives/crisp/3x/005_200504-1.jpg 3x"/></p>
<h2 id="_1">記事が重複する？</h2>
<p>サイト公開当初は 1 種類のコレクション（ Markdown ）から GraphQL の Filter を使って、3 種類のコンテンツを抽出していました。</p>
<div class="highlight"><pre><span></span><code>// コンテンツ抽出イメージ

コレクション（*.md）
|
|___ Blogコンテンツ（Post.vue）
|___ Graphicコンテンツ（Graphic.vue）
|___ Photoコンテンツ（Photo.vue）
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1">// gridsome.config.js（サイト公開当初の設定、一部抜粋）</span><span class="w"></span>

<span class="nx">plugins</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nx">use</span><span class="o">:</span><span class="w"> </span><span class="s1">'@gridsome/source-filesystem'</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nx">options</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="nx">path</span><span class="o">:</span><span class="w"> </span><span class="s1">'static/posts/**/**/*.md'</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nx">typeName</span><span class="o">:</span><span class="w"> </span><span class="s1">'Post'</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nx">remark</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nx">plugins</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">'@gridsome/remark-prismjs'</span><span class="p">]</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">]</span><span class="w"></span>

<span class="err">（</span><span class="nx">中略</span><span class="err">）</span><span class="w"></span>

<span class="nx">templates</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nx">Post</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="c1">// ブログ用</span><span class="w"></span>
<span class="w">      </span><span class="nx">path</span><span class="o">:</span><span class="w"> </span><span class="s1">'/posts/:slug'</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nx">component</span><span class="o">:</span><span class="w"> </span><span class="s1">'./src/templates/Post.vue'</span><span class="w"></span>
<span class="w">    </span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="c1">// グラフィック作品用</span><span class="w"></span>
<span class="w">      </span><span class="nx">path</span><span class="o">:</span><span class="w"> </span><span class="s1">'/graphics/:slug'</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nx">component</span><span class="o">:</span><span class="w"> </span><span class="s1">'./src/templates/Graphic.vue'</span><span class="w"></span>
<span class="w">    </span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="c1">// 写真作品用</span><span class="w"></span>
<span class="w">      </span><span class="nx">path</span><span class="o">:</span><span class="w"> </span><span class="s1">'/photos/:slug'</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nx">component</span><span class="o">:</span><span class="w"> </span><span class="s1">'./src/templates/Photo.vue'</span><span class="w"></span>
<span class="w">    </span><span class="p">},</span><span class="w"></span>
<span class="w">  </span><span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>↑ をすることで上手いこと生成してくれるかと思いきや・・・以下のようにファイルが生成されてしまいました。</p>
<div class="highlight"><pre><span></span><code>// この重複っぷりったら（笑）

dist
|
|__ posts
|   |__ Blogコンテンツ1
|   |   |__ index.html
|   |__ Blogコンテンツ2
|   |   |__ index.html
|   |__ Graphicコンテンツ1（本来不要）
|   |   |__ index.html
|   |__ Photoコンテンツ1（本来不要）
|   |   |__ index.html
|   |__ Photoコンテンツ2（本来不要）
|       |__ index.html
|
|__ graphic
|   |__ Blogコンテンツ1（本来不要）
|   |   |__ index.html
|   |__ Blogコンテンツ2（本来不要）
|   |   |__ index.html
|   |__ Graphicコンテンツ1
|   |   |__ index.html
|   |__ Photoコンテンツ1（本来不要）
|   |   |__ index.html
|   |__ Photoコンテンツ2（本来不要）
|       |__ index.html
|
|__ photo
    |__ Blogコンテンツ1（本来不要）
    |   |__ index.html
    |__ Blogコンテンツ2（本来不要）
    |   |__ index.html
    |__ Graphicコンテンツ1（本来不要）
    |   |__ index.html
    |__ Photoコンテンツ1
    |   |__ index.html
    |__ Photoコンテンツ2
        |__ index.html
</code></pre></div>
<p>URL としてはすべてのルートが生成されているので、このままサーバーにアップロードしたら同じ記事だらけで「どれが本物か！？」と Google さんは思うでしょう。実際、Search Console には「重複してるよ」って言われました。</p>
<p>というわけで対策を考えます。</p>
<h2 id="1-robotstxt">対策(1) robots.txt → 失敗</h2>
<p>まず思いついたのは robots.txt です。</p>
<p>Gridsome の gridsome-plugin-robots プラグインを使って、特定の URL のみ disallow とすることでした。</p>
<div class="highlight"><pre><span></span><code><span class="c1">// gridsome.config.js（サイト公開当初の設定、一部抜粋）</span><span class="w"></span>

<span class="nx">plugins</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>

<span class="err">（</span><span class="nx">中略</span><span class="err">）</span><span class="w"></span>

<span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nx">use</span><span class="o">:</span><span class="w"> </span><span class="s1">'gridsome-plugin-robots'</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nx">options</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="nx">host</span><span class="o">:</span><span class="w"> </span><span class="s1">'https://portfolio.nnamm.com'</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nx">sitemap</span><span class="o">:</span><span class="w"> </span><span class="s1">'https://portfolio.nnamm.com/sitemap.xml'</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nx">policy</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="nx">userAgent</span><span class="o">:</span><span class="w"> </span><span class="s1">'*'</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="nx">allow</span><span class="o">:</span><span class="w"> </span><span class="s1">'/'</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="nx">disallow</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">            </span><span class="s1">'/posts/p0*'</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="s1">'/posts/g0*'</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="s1">'/photos/b0*'</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="s1">'/photos/g0*'</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="s1">'/graphics/b0*'</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="s1">'/graphics/p0*'</span><span class="w"></span>
<span class="w">          </span><span class="p">]</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">      </span><span class="p">]</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>しかし、これは disallow が約束されたものではありません。想定していない URL がインデックスされる可能性がありますし、実際されちゃいました。</p>
<h2 id="2-v-if">対策(2) v-if を使って分ける → 成功</h2>
<p>もともと Blog/Graphic/Photo それぞれにテンプレート（ vue ファイル）を作り、デザインを分けていましたが、<strong>1 つの vue ファイルに統合して、処理を切り分ければ良いんじゃなーい？</strong>と気づきます。</p>
<p>「これだ！」というわけで、ベストプラクティスかはわかりませんが以下のようにしました。</p>
<ol>
<li>URL のスラッグの先頭に投稿タイプの文字列を追加（ Blog なら b、Graphic なら g、Photo なら p → 例. b0001-200322-start-portfolio-site ）</li>
<li>computed で GraphQL からスラッグの頭文字を取得</li>
<li>v-if="postType === 'b'"のようにして処理を分ける</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="c1">// Post.vue（一部抜粋）</span><span class="w"></span>

<span class="o">&lt;</span><span class="nx">template</span><span class="o">&gt;</span><span class="w"></span>
<span class="w">  </span><span class="o">&lt;</span><span class="nx">Layout</span><span class="o">&gt;</span><span class="w"></span>

<span class="w">    </span><span class="o">&lt;</span><span class="nx">template</span><span class="w"> </span><span class="nx">v</span><span class="o">-</span><span class="nx">slot</span><span class="o">:</span><span class="nx">main</span><span class="o">-</span><span class="nx">contents</span><span class="o">&gt;</span><span class="w"></span>
<span class="w">      </span><span class="o">&lt;</span><span class="nx">div</span><span class="w"> </span><span class="nx">v</span><span class="o">-</span><span class="k">if</span><span class="o">=</span><span class="s2">"postType === 'b'"</span><span class="o">&gt;</span><span class="w"></span>
<span class="w">        </span><span class="err">〜</span><span class="w"> </span><span class="nx">Blog用のデザイン</span><span class="w"> </span><span class="err">〜</span><span class="w"></span>
<span class="w">      </span><span class="o">&lt;</span><span class="err">/div&gt;</span><span class="w"></span>

<span class="w">      </span><span class="o">&lt;</span><span class="nx">div</span><span class="w"> </span><span class="nx">v</span><span class="o">-</span><span class="k">else</span><span class="o">-</span><span class="k">if</span><span class="o">=</span><span class="s2">"postType === 'g'"</span><span class="o">&gt;</span><span class="w"></span>
<span class="w">        </span><span class="err">〜</span><span class="w"> </span><span class="nx">Graphic用のデザイン</span><span class="w"> </span><span class="err">〜</span><span class="w"></span>
<span class="w">      </span><span class="o">&lt;</span><span class="err">/div&gt;</span><span class="w"></span>

<span class="w">      </span><span class="o">&lt;</span><span class="nx">div</span><span class="w"> </span><span class="nx">v</span><span class="o">-</span><span class="k">else</span><span class="o">&gt;</span><span class="w"></span>
<span class="w">        </span><span class="err">〜</span><span class="w"> </span><span class="nx">Photo用のデザイン</span><span class="w"> </span><span class="err">〜</span><span class="w"></span>
<span class="w">      </span><span class="o">&lt;</span><span class="err">/div&gt;</span><span class="w"></span>
<span class="w">    </span><span class="o">&lt;</span><span class="err">/template&gt;</span><span class="w"></span>

<span class="w">  </span><span class="o">&lt;</span><span class="err">/Layout&gt;</span><span class="w"></span>
<span class="o">&lt;</span><span class="err">/template&gt;</span><span class="w"></span>

<span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nx">computed</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nx">postType</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">$page</span><span class="p">.</span><span class="nx">article</span><span class="p">.</span><span class="nx">slug</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="o">&lt;</span><span class="err">/script&gt;</span><span class="w"></span>

<span class="err">※</span><span class="nx">$pageでGraphQLした結果にアクセスできるのでslugから文字を取得</span><span class="w"></span>

<span class="o">&lt;</span><span class="nx">page</span><span class="o">-</span><span class="nx">query</span><span class="o">&gt;</span><span class="w"></span>
<span class="nx">query</span><span class="w"> </span><span class="nx">Post</span><span class="w"> </span><span class="p">(</span><span class="nx">$path</span><span class="o">:</span><span class="w"> </span><span class="nb">String</span><span class="o">!</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nx">article</span><span class="o">:</span><span class="w"> </span><span class="nx">post</span><span class="w"> </span><span class="p">(</span><span class="nx">path</span><span class="o">:</span><span class="w"> </span><span class="nx">$path</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nx">id</span><span class="w"></span>
<span class="w">    </span><span class="nx">title</span><span class="w"></span>
<span class="w">    </span><span class="nx">createdAt</span><span class="w"> </span><span class="p">(</span><span class="nx">format</span><span class="o">:</span><span class="w"> </span><span class="s2">"YYYY.MM.DD"</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="nx">updatedAt</span><span class="w"> </span><span class="p">(</span><span class="nx">format</span><span class="o">:</span><span class="w"> </span><span class="s2">"YYYY.MM.DD"</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="nx">description</span><span class="w"></span>
<span class="w">    </span><span class="nx">content</span><span class="w"></span>
<span class="w">    </span><span class="nx">image</span><span class="w"></span>
<span class="w">    </span><span class="nx">slug</span><span class="w"></span>
<span class="w">    </span><span class="nx">category</span><span class="w"></span>
<span class="w">    </span><span class="nx">tags</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="o">&lt;</span><span class="err">/page-query&gt;</span><span class="w"></span>
</code></pre></div>
<p>結果、Build すると想定したものだけが生成されていました。スッキリ！</p>
<div class="highlight"><pre><span></span><code>dist
|
|__ posts
    |__ Blogコンテンツ1
    |   |__ index.html
    |
    |__ Blogコンテンツ2
    |   |__ index.html
    |
    |__ Graphicコンテンツ1
    |   |__ index.html
    |
    |__ Photoコンテンツ1
    |   |__ index.html
    |
    |__ Photoコンテンツ2
        |__ index.html
</code></pre></div>
<h2 id="_2">おわりに</h2>
<p>Vue.js の条件付きンダリングを使って対応した、というお話でした。</p>
<p>Gridsome はこのような仕様でしたが（僕の使い方が正しいか判断できませんが）、他の SSG はどうなんでしょうね。有名な Nuxt.js や Gatsby.js なんかも同じような感じなのかな。興味が湧いてきました。</p>
<p>とはいえ、まずは無駄なファイルが生成されずスッキリして良かったです。サーバーのディレクトリ構成や URL にこだわりがなければ、この対応で良いと思いますね。</p>
<p>あとは Search Console のインデックスが更新されたらオッケー。しばらく様子見です。</p>
<p><img alt="" class="image-process-crisp" loading="lazy" src="../../images/posts/derivatives/crisp/1x/005_200504-2.jpg" srcset="../../images/posts/derivatives/crisp/1x/005_200504-2.jpg 1x, ../../images/posts/derivatives/crisp/2x/005_200504-2.jpg 2x, ../../images/posts/derivatives/crisp/3x/005_200504-2.jpg 3x"/></p>
<p>※掲載した写真は春の大阪城公園を RICOH GR で撮影</p>
</div>
<div class="w-full md:max-w-3xl md:mx-auto mt-12 mb-20 px-4 md:px-10">
<div>
<svg class="inline-block w-4 h-4 fill-current text-gray-700 py-0.5" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M11 5c-1.629 0-2.305-1.058-4-3h-7v20h24v-17h-13z"></path>
</svg>
<a class="metadata-category-link inline-block mr-2" href="/category/creative.html">
    Creative
  </a>
<div class="inline md:hidden"><br/></div>
<svg class="inline-block w-4 h-4 fill-current text-gray-700 py-0.5" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M10.605 0h-10.605v10.609l13.391 13.391 10.609-10.604-13.395-13.396zm-4.191 6.414c-.781.781-2.046.781-2.829.001-.781-.783-.781-2.048 0-2.829.782-.782 2.048-.781 2.829-.001.782.782.781 2.047 0 2.829z"></path>
</svg>
<a class="metadata-tags-link inline-block" href="/tag/gridsome.html">
      Gridsome
    </a>
<a class="metadata-tags-link inline-block" href="/tag/vuejs.html">
      Vue.js
    </a>
</div> </div>
</article>
<footer><div class="flex flex-col justify-center items-center bg-white border-t border-gray-200 mt-8 pt-12 pb-8">
<div class="flex flex-row justify-evenly w-7/12 md:w-4/12 mb-8">
<a href="https://nnamm.com" target="_blank">
<svg class="footer-external-link" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M2.597 7.81l4.911 13.454c-3.434-1.668-5.802-.19-5.802-9.264 0-1.493.32-2.91.891-4.19zm16.352 3.67c0-1.272-.457-2.153-.849-2.839-.521-.849-1.011-1.566-1.011-2.415 0-.978.747-1.88 1.862-1.819-1.831-1.677-4.271-2.701-6.951-2.701-3.596 0-6.76 1.845-8.601 4.64.625.02 1.489.032 3.406-.118.555-.034.62.782.066.847 0 0-.558.065-1.178.098l3.749 11.15 2.253-6.756-1.604-4.394c-.555-.033-1.08-.098-1.08-.098-.555-.033-.49-.881.065-.848 2.212.17 3.271.171 5.455 0 .555-.033.621.783.066.848 0 0-.559.065-1.178.098l3.72 11.065 1.027-3.431c.444-1.423.783-2.446.783-3.327zm-6.768 1.42l-3.089 8.975c.922.271 1.898.419 2.908.419 1.199 0 2.349-.207 3.418-.583-.086-.139-3.181-8.657-3.237-8.811zm8.852-5.839c.224 1.651-.099 3.208-.713 4.746l-3.145 9.091c3.061-1.784 5.119-5.1 5.119-8.898 0-1.79-.457-3.473-1.261-4.939zm2.967 4.939c0 6.617-5.384 12-12 12s-12-5.383-12-12 5.383-12 12-12 12 5.383 12 12zm-.55 0c0-6.313-5.137-11.45-11.45-11.45s-11.45 5.137-11.45 11.45 5.137 11.45 11.45 11.45 11.45-5.137 11.45-11.45z"></path>
</svg>
</a>
<a href="https://www.facebook.com/t.hanamura.photography/" target="_blank">
<svg class="footer-external-link" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm3 8h-1.35c-.538 0-.65.221-.65.778v1.222h2l-.209 2h-1.791v7h-3v-7h-2v-2h2v-2.308c0-1.769.931-2.692 3.029-2.692h1.971v3z"></path>
</svg>
</a>
<a href="https://twitter.com/nnammg" target="_blank">
<svg class="footer-external-link" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z">
</path>
</svg>
</a>
<a href="https://github.com/nnamm" target="_blank">
<svg class="footer-external-link" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path>
</svg>
</a>
<a href="https://www.youtube.com/channel/UCvXy78MlFBKnNDMcSrqnOnA" target="_blank">
<svg class="footer-external-link" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"></path>
</svg>
</a>
</div>
<div class="flex flex-col text-center">
<address class="text-xs not-italic mb-2">
      Powered by <a class="underline" href="https://getpelican.com/" target="_blank">Pelican</a>,
      which takes great advantage of <a class="underline" href="https://www.python.org/" target="_blank">Python</a>.
    </address>
<small><a class="hover:text-pink-400 transition-colors" href="/">nnamm.work</a> ©2020</small>
</div>
</div></footer>
<script>
  let mobileMenuButton = document.getElementById('mobileMenuButton')
  mobileMenuButton.onclick = function () {
    document.getElementById('sideMenuHideOnMobile').classList.toggle('-translate-y-full')
    document.getElementById('sideMenuHideOnMobile').classList.toggle('mt-12')
    document.getElementById('sideMenuHideOnMobile').classList.toggle('shadow')
    document.getElementById('mobileMenuButtonClose').classList.toggle('hidden')
    document.getElementById('mobileMenuButtonOpen').classList.toggle('hidden')
  }
  // Hide element when click outside nav
  let theElementContainer = document.getElementsByTagName('nav')[0]
  document.addEventListener('click', function (event) {
    if (!theElementContainer.contains(event.target)) {
      document.getElementById('sideMenuHideOnMobile').classList.add('-translate-y-full')
      document.getElementById('sideMenuHideOnMobile').classList.remove('mt-12')
      document.getElementById('sideMenuHideOnMobile').classList.remove('shadow')
      document.getElementById('mobileMenuButtonOpen').classList.remove('hidden')
      document.getElementById('mobileMenuButtonClose').classList.add('hidden')
    }
  })
</script>
<script>
  window.addEventListener('load', () => {
    viewSlide('.slideshow img')
  })

  function viewSlide(className, slideNo = -1) {
    let imgArray = document.querySelectorAll(className)
    if (imgArray.length) {
      if (slideNo >= 0) {
        imgArray[slideNo].style.opacity = '0'
      }
      slideNo++
      if (slideNo >= imgArray.length) {
        slideNo = 0
      }
      imgArray[slideNo].style.opacity = '1'
      let msec = 5000
      setTimeout(() => {
        viewSlide(className, slideNo)
      }, msec)
    }
  }
</script>
<script>
  let scrollAnimationElm = document.querySelectorAll('.profile-box')
  let scrollAnimationFunc = () => {
    for (let i = 0; i < scrollAnimationElm.length; i++) {
      let triggerMargin = 600
      if (window.innerHeight > scrollAnimationElm[i].getBoundingClientRect().top + triggerMargin) {
        scrollAnimationElm[i].classList.add('show')
      }
    }
  }
  window.addEventListener('load', scrollAnimationFunc)
  window.addEventListener('scroll', scrollAnimationFunc)
</script>
</body>
</html>